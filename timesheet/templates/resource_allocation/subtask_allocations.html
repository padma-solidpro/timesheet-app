<li class="list-group-item"
    data-task-id="{{ subtask_assignment.task.id }}"
    data-subtask-id="{{ subtask_assignment.subtask.id }}">

  {% with subtask_uid="subtask-"|add:subtask_assignment.id|stringformat:"s" %}
  <div class="d-flex justify-content-between align-items-center">
    <a class="text-decoration-none" data-bs-toggle="collapse" href="#{{ subtask_uid }}" role="button" aria-expanded="false" aria-controls="{{ subtask_uid }}">
      {{ subtask_assignment.subtask.name }}
    </a>
    <span>{{ subtask_assignment.allotted_hours }} hrs</span>

    <button class="btn btn-sm btn-success assign-resource-btn"
            data-bs-toggle="modal"
            data-bs-target="#assignResourceModal"
            data-project-id="{{ project.id }}"
            data-task-id="{{ subtask_assignment.task.id }}"
            data-subtask-id="{{ subtask_assignment.subtask.id }}">
      + Assign Resource
    </button>
  </div>

  {% if allocations %}
  <ul class="list-group ms-3 collapse mt-2" id="{{ subtask_uid }}">
    {% for allocation in allocations %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <span>{{ allocation.resource.name }}</span>
        <span>{{ allocation.assigned_hours }} hrs</span>
        <div>
          <button class="btn btn-sm btn-outline-primary edit-allocation"
                  data-allocation-id="{{ allocation.id }}">Edit</button>
          <button class="btn btn-sm btn-outline-danger"
                  hx-post="{% url 'remove_resource_allocation' %}"
                  hx-trigger="click"
                  hx-target="closest li"
                  hx-swap="outerHTML"
                  hx-vals='{"allocation_id": "{{ allocation.id }}"}'>Delete</button>
        </div>
      </li>
    {% endfor %}
  </ul>
  {% endif %}
  {% endwith %}
</li>
